<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  $Headers</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (c) 2021 Brian W Bush</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  MIT</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  :  Brian W Bush &lt;code@functionally.io&gt;</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Stability   :  Experimental</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Portability :  Portable</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- | Handling transactions.</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts  #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE GADTs             #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards   #-}</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Mantis.Transaction</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-23"></span><span class="annot"><span class="hs-comment">-- * Transactions</span></span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Mantis.Transaction.html#makeTransaction"><span class="hs-identifier">makeTransaction</span></a></span><span>
</span><span id="line-25"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mantis.Transaction.html#includeFee"><span class="hs-identifier">includeFee</span></a></span><span>
</span><span id="line-26"></span><span class="annot"><span class="hs-comment">-- * Metadata</span></span><span>
</span><span id="line-27"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mantis.Transaction.html#readMetadata"><span class="hs-identifier">readMetadata</span></a></span><span>
</span><span id="line-28"></span><span class="annot"><span class="hs-comment">-- * Printing</span></span><span>
</span><span id="line-29"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mantis.Transaction.html#printUTxO"><span class="hs-identifier">printUTxO</span></a></span><span>
</span><span id="line-30"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mantis.Transaction.html#printValue"><span class="hs-identifier">printValue</span></a></span><span>
</span><span id="line-31"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mantis.Transaction.html#printValueIO"><span class="hs-identifier">printValueIO</span></a></span><span>
</span><span id="line-32"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mantis.Transaction.html#summarizeValues"><span class="hs-identifier">summarizeValues</span></a></span><span>
</span><span id="line-33"></span><span class="annot"><span class="hs-comment">-- * Minting</span></span><span>
</span><span id="line-34"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mantis.Transaction.html#makeMinting"><span class="hs-identifier">makeMinting</span></a></span><span>
</span><span id="line-35"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mantis.Transaction.html#readMinting"><span class="hs-identifier">readMinting</span></a></span><span>
</span><span id="line-36"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mantis.Transaction.html#supportedMultiAsset"><span class="hs-identifier">supportedMultiAsset</span></a></span><span>
</span><span id="line-37"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">AssetId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">AssetName</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">AuxScriptsSupportedInEra</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CardanoEra</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MultiAssetSupportedInEra</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Hash</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MaryEra</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NetworkId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PaymentKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PolicyId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Quantity</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ScriptInEra</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SlotNo</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxAuxScripts</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxCertificates</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxFee</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxFeesExplicitInEra</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxMetadata</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxMetadataInEra</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxMetadataSupportedInEra</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxMetadataJsonSchema</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxMintValue</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxUpdateProposal</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxValidityLowerBound</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxValidityUpperBound</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxWithdrawals</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidityNoUpperBoundSupportedInEra</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidityUpperBoundSupportedInEra</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Value</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">auxScriptsSupportedInEra</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">estimateTransactionFee</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">filterValue</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lovelaceToValue</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">makeSignedTransaction</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">makeTransactionBody</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">metadataFromJson</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">multiAssetSupportedInEra</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">negateValue</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">selectLovelace</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">serialiseToRawBytesHex</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">txFeesExplicitInEra</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">validityNoUpperBoundSupportedInEra</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">validityUpperBoundSupportedInEra</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">valueFromList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">valueToList</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.Shelley</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ProtocolParameters</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxBodyContent</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxIn</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxOut</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxOutValue</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UTxO</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">protocolParamTxFeeFixed</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">protocolParamTxFeePerByte</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Mantis.Script.html"><span class="hs-identifier">Mantis.Script</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mantis.Script.html#mintingScript"><span class="hs-identifier">mintingScript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Mantis.Types.html"><span class="hs-identifier">Mantis.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mantis.Types.html#MantisM"><span class="hs-identifier">MantisM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mantis.Types.html#foistMantisEither"><span class="hs-identifier">foistMantisEither</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mantis.Types.html#foistMantisMaybeIO"><span class="hs-identifier">foistMantisMaybeIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Value</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">decodeFileStrict</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">keys</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">singleton</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">assocs</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | The Mary era supports having no upper bound.</span><span>
</span><span id="line-54"></span><span class="annot"><a href="Mantis.Transaction.html#supportedNoUpperBound"><span class="hs-identifier hs-type">supportedNoUpperBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ValidityNoUpperBoundSupportedInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span>
</span><span id="line-55"></span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="supportedNoUpperBound"><span class="annot"><span class="annottext">ValidityNoUpperBoundSupportedInEra MaryEra
</span><a href="Mantis.Transaction.html#supportedNoUpperBound"><span class="hs-identifier hs-var">supportedNoUpperBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra
-&gt; Maybe (ValidityNoUpperBoundSupportedInEra MaryEra)
forall era.
CardanoEra era -&gt; Maybe (ValidityNoUpperBoundSupportedInEra era)
</span><span class="hs-identifier hs-var">validityNoUpperBoundSupportedInEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra
</span><span class="hs-identifier hs-var">MaryEra</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | The Mary era support upper bounds.</span><span>
</span><span id="line-59"></span><span class="annot"><a href="Mantis.Transaction.html#supportedUpperBound"><span class="hs-identifier hs-type">supportedUpperBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ValidityUpperBoundSupportedInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span>
</span><span id="line-60"></span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="supportedUpperBound"><span class="annot"><span class="annottext">ValidityUpperBoundSupportedInEra MaryEra
</span><a href="Mantis.Transaction.html#supportedUpperBound"><span class="hs-identifier hs-var">supportedUpperBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra
-&gt; Maybe (ValidityUpperBoundSupportedInEra MaryEra)
forall era.
CardanoEra era -&gt; Maybe (ValidityUpperBoundSupportedInEra era)
</span><span class="hs-identifier hs-var">validityUpperBoundSupportedInEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra
</span><span class="hs-identifier hs-var">MaryEra</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | The Mary era supports multi-assets.</span><span>
</span><span id="line-64"></span><span class="annot"><a href="Mantis.Transaction.html#supportedMultiAsset"><span class="hs-identifier hs-type">supportedMultiAsset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MultiAssetSupportedInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span>
</span><span id="line-65"></span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="supportedMultiAsset"><span class="annot"><span class="annottext">MultiAssetSupportedInEra MaryEra
</span><a href="Mantis.Transaction.html#supportedMultiAsset"><span class="hs-identifier hs-var">supportedMultiAsset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra
-&gt; Either
     (OnlyAdaSupportedInEra MaryEra) (MultiAssetSupportedInEra MaryEra)
forall era.
CardanoEra era
-&gt; Either
     (OnlyAdaSupportedInEra era) (MultiAssetSupportedInEra era)
</span><span class="hs-identifier hs-var">multiAssetSupportedInEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra
</span><span class="hs-identifier hs-var">MaryEra</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | The Mary era supports scripts.</span><span>
</span><span id="line-69"></span><span class="annot"><a href="Mantis.Transaction.html#supportedScripts"><span class="hs-identifier hs-type">supportedScripts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AuxScriptsSupportedInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span>
</span><span id="line-70"></span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="supportedScripts"><span class="annot"><span class="annottext">AuxScriptsSupportedInEra MaryEra
</span><a href="Mantis.Transaction.html#supportedScripts"><span class="hs-identifier hs-var">supportedScripts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra -&gt; Maybe (AuxScriptsSupportedInEra MaryEra)
forall era. CardanoEra era -&gt; Maybe (AuxScriptsSupportedInEra era)
</span><span class="hs-identifier hs-var">auxScriptsSupportedInEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra
</span><span class="hs-identifier hs-var">MaryEra</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | The Mary era has explicit fees.</span><span>
</span><span id="line-74"></span><span class="annot"><a href="Mantis.Transaction.html#explicitFees"><span class="hs-identifier hs-type">explicitFees</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxFeesExplicitInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span>
</span><span id="line-75"></span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="explicitFees"><span class="annot"><span class="annottext">TxFeesExplicitInEra MaryEra
</span><a href="Mantis.Transaction.html#explicitFees"><span class="hs-identifier hs-var">explicitFees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra
-&gt; Either
     (TxFeesImplicitInEra MaryEra) (TxFeesExplicitInEra MaryEra)
forall era.
CardanoEra era
-&gt; Either (TxFeesImplicitInEra era) (TxFeesExplicitInEra era)
</span><span class="hs-identifier hs-var">txFeesExplicitInEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra
</span><span class="hs-identifier hs-var">MaryEra</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | Build a transaction.</span><span>
</span><span id="line-79"></span><span class="annot"><a href="Mantis.Transaction.html#makeTransaction"><span class="hs-identifier hs-type">makeTransaction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span class="hs-special">]</span><span>                      </span><span class="hs-comment">-- ^ The UTxOs to be spent.</span><span>
</span><span id="line-80"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ The output UTxOs.</span><span>
</span><span id="line-81"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>                </span><span class="hs-comment">-- ^ The latest slot for the transaction.</span><span>
</span><span id="line-82"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxMetadata</span></span><span>            </span><span class="hs-comment">-- ^ The metadata.</span><span>
</span><span id="line-83"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ScriptInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The script</span><span>
</span><span id="line-84"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span>                 </span><span class="hs-comment">-- ^ The value to be minted.</span><span>
</span><span id="line-85"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBodyContent</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span>
</span><span id="line-86"></span><span id="makeTransaction"><span class="annot"><span class="annottext">makeTransaction :: [TxIn]
-&gt; [TxOut MaryEra]
-&gt; Maybe SlotNo
-&gt; Maybe TxMetadata
-&gt; Maybe (ScriptInEra MaryEra)
-&gt; Maybe Value
-&gt; TxBodyContent MaryEra
</span><a href="Mantis.Transaction.html#makeTransaction"><span class="hs-identifier hs-var hs-var">makeTransaction</span></a></span></span><span> </span><span id="local-6989586621679123605"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679123605"><span class="hs-identifier hs-var">txIns</span></a></span></span><span> </span><span id="local-6989586621679123604"><span class="annot"><span class="annottext">[TxOut MaryEra]
</span><a href="#local-6989586621679123604"><span class="hs-identifier hs-var">txOuts</span></a></span></span><span> </span><span id="local-6989586621679123603"><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="#local-6989586621679123603"><span class="hs-identifier hs-var">before</span></a></span></span><span> </span><span id="local-6989586621679123602"><span class="annot"><span class="annottext">Maybe TxMetadata
</span><a href="#local-6989586621679123602"><span class="hs-identifier hs-var">metadata</span></a></span></span><span> </span><span id="local-6989586621679123601"><span class="annot"><span class="annottext">Maybe (ScriptInEra MaryEra)
</span><a href="#local-6989586621679123601"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span id="local-6989586621679123600"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679123600"><span class="hs-identifier hs-var">minting</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679123599"><span class="annot"><span class="annottext">txFee :: TxFee MaryEra
</span><a href="#local-6989586621679123599"><span class="hs-identifier hs-var hs-var">txFee</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxFeesExplicitInEra MaryEra -&gt; Lovelace -&gt; TxFee MaryEra
forall era. TxFeesExplicitInEra era -&gt; Lovelace -&gt; TxFee era
</span><span class="hs-identifier hs-var">TxFeeExplicit</span></span><span> </span><span class="annot"><span class="annottext">TxFeesExplicitInEra MaryEra
</span><a href="Mantis.Transaction.html#explicitFees"><span class="hs-identifier hs-var">explicitFees</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><span class="hs-number">0</span></span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621679123597"><span class="annot"><span class="annottext">txValidityRange :: (TxValidityLowerBound MaryEra, TxValidityUpperBound MaryEra)
</span><a href="#local-6989586621679123597"><span class="hs-identifier hs-var hs-var">txValidityRange</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-90"></span><span>                         </span><span class="annot"><span class="annottext">TxValidityLowerBound MaryEra
forall era. TxValidityLowerBound era
</span><span class="hs-identifier hs-var">TxValidityNoLowerBound</span></span><span>
</span><span id="line-91"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxValidityUpperBound MaryEra
-&gt; (SlotNo -&gt; TxValidityUpperBound MaryEra)
-&gt; Maybe SlotNo
-&gt; TxValidityUpperBound MaryEra
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-92"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidityNoUpperBoundSupportedInEra MaryEra
-&gt; TxValidityUpperBound MaryEra
forall era.
ValidityNoUpperBoundSupportedInEra era -&gt; TxValidityUpperBound era
</span><span class="hs-identifier hs-var">TxValidityNoUpperBound</span></span><span> </span><span class="annot"><span class="annottext">ValidityNoUpperBoundSupportedInEra MaryEra
</span><a href="Mantis.Transaction.html#supportedNoUpperBound"><span class="hs-identifier hs-var">supportedNoUpperBound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidityUpperBoundSupportedInEra MaryEra
-&gt; SlotNo -&gt; TxValidityUpperBound MaryEra
forall era.
ValidityUpperBoundSupportedInEra era
-&gt; SlotNo -&gt; TxValidityUpperBound era
</span><span class="hs-identifier hs-var">TxValidityUpperBound</span></span><span> </span><span class="annot"><span class="annottext">ValidityUpperBoundSupportedInEra MaryEra
</span><a href="Mantis.Transaction.html#supportedUpperBound"><span class="hs-identifier hs-var">supportedUpperBound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>                           </span><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="#local-6989586621679123603"><span class="hs-identifier hs-var">before</span></a></span><span>
</span><span id="line-95"></span><span>                       </span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621679123592"><span class="annot"><span class="annottext">txMetadata :: TxMetadataInEra MaryEra
</span><a href="#local-6989586621679123592"><span class="hs-identifier hs-var hs-var">txMetadata</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxMetadataInEra MaryEra
-&gt; (TxMetadata -&gt; TxMetadataInEra MaryEra)
-&gt; Maybe TxMetadata
-&gt; TxMetadataInEra MaryEra
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">TxMetadataInEra MaryEra
forall era. TxMetadataInEra era
</span><span class="hs-identifier hs-var">TxMetadataNone</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMetadataSupportedInEra MaryEra
-&gt; TxMetadata -&gt; TxMetadataInEra MaryEra
forall era.
TxMetadataSupportedInEra era -&gt; TxMetadata -&gt; TxMetadataInEra era
</span><span class="hs-identifier hs-var">TxMetadataInEra</span></span><span> </span><span class="annot"><span class="annottext">TxMetadataSupportedInEra MaryEra
</span><span class="hs-identifier hs-var">TxMetadataInMaryEra</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe TxMetadata
</span><a href="#local-6989586621679123602"><span class="hs-identifier hs-var">metadata</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679123588"><span class="annot"><span class="annottext">txAuxScripts :: TxAuxScripts MaryEra
</span><a href="#local-6989586621679123588"><span class="hs-identifier hs-var hs-var">txAuxScripts</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxAuxScripts MaryEra
-&gt; (ScriptInEra MaryEra -&gt; TxAuxScripts MaryEra)
-&gt; Maybe (ScriptInEra MaryEra)
-&gt; TxAuxScripts MaryEra
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">TxAuxScripts MaryEra
forall era. TxAuxScripts era
</span><span class="hs-identifier hs-var">TxAuxScriptsNone</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuxScriptsSupportedInEra MaryEra
-&gt; [ScriptInEra MaryEra] -&gt; TxAuxScripts MaryEra
forall era.
AuxScriptsSupportedInEra era
-&gt; [ScriptInEra era] -&gt; TxAuxScripts era
</span><span class="hs-identifier hs-var">TxAuxScripts</span></span><span> </span><span class="annot"><span class="annottext">AuxScriptsSupportedInEra MaryEra
</span><a href="Mantis.Transaction.html#supportedScripts"><span class="hs-identifier hs-var">supportedScripts</span></a></span><span> </span><span class="annot"><span class="annottext">([ScriptInEra MaryEra] -&gt; TxAuxScripts MaryEra)
-&gt; (ScriptInEra MaryEra -&gt; [ScriptInEra MaryEra])
-&gt; ScriptInEra MaryEra
-&gt; TxAuxScripts MaryEra
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ScriptInEra MaryEra -&gt; [ScriptInEra MaryEra]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (ScriptInEra MaryEra)
</span><a href="#local-6989586621679123601"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679123584"><span class="annot"><span class="annottext">txWithdrawals :: TxWithdrawals era
</span><a href="#local-6989586621679123584"><span class="hs-identifier hs-var hs-var">txWithdrawals</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxWithdrawals era
forall era. TxWithdrawals era
</span><span class="hs-identifier hs-var">TxWithdrawalsNone</span></span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679123582"><span class="annot"><span class="annottext">txCertificates :: TxCertificates era
</span><a href="#local-6989586621679123582"><span class="hs-identifier hs-var hs-var">txCertificates</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxCertificates era
forall era. TxCertificates era
</span><span class="hs-identifier hs-var">TxCertificatesNone</span></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679123580"><span class="annot"><span class="annottext">txUpdateProposal :: TxUpdateProposal era
</span><a href="#local-6989586621679123580"><span class="hs-identifier hs-var hs-var">txUpdateProposal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxUpdateProposal era
forall era. TxUpdateProposal era
</span><span class="hs-identifier hs-var">TxUpdateProposalNone</span></span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679123578"><span class="annot"><span class="annottext">txMintValue :: TxMintValue MaryEra
</span><a href="#local-6989586621679123578"><span class="hs-identifier hs-var hs-var">txMintValue</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxMintValue MaryEra
-&gt; (Value -&gt; TxMintValue MaryEra)
-&gt; Maybe Value
-&gt; TxMintValue MaryEra
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">TxMintValue MaryEra
forall era. TxMintValue era
</span><span class="hs-identifier hs-var">TxMintNone</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MultiAssetSupportedInEra MaryEra -&gt; Value -&gt; TxMintValue MaryEra
forall era.
MultiAssetSupportedInEra era -&gt; Value -&gt; TxMintValue era
</span><span class="hs-identifier hs-var">TxMintValue</span></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra MaryEra
</span><a href="Mantis.Transaction.html#supportedMultiAsset"><span class="hs-identifier hs-var">supportedMultiAsset</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679123600"><span class="hs-identifier hs-var">minting</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">TxBodyContent :: forall era.
[TxIn]
-&gt; [TxOut era]
-&gt; TxFee era
-&gt; (TxValidityLowerBound era, TxValidityUpperBound era)
-&gt; TxMetadataInEra era
-&gt; TxAuxScripts era
-&gt; TxWithdrawals era
-&gt; TxCertificates era
-&gt; TxUpdateProposal era
-&gt; TxMintValue era
-&gt; TxBodyContent era
</span><span class="hs-identifier hs-type">TxBodyContent</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">[TxIn]
[TxOut MaryEra]
(TxValidityLowerBound MaryEra, TxValidityUpperBound MaryEra)
TxAuxScripts MaryEra
TxCertificates MaryEra
TxFee MaryEra
TxMetadataInEra MaryEra
TxMintValue MaryEra
TxUpdateProposal MaryEra
TxWithdrawals MaryEra
forall era. TxCertificates era
forall era. TxUpdateProposal era
forall era. TxWithdrawals era
txWithdrawals :: TxWithdrawals MaryEra
txValidityRange :: (TxValidityLowerBound MaryEra, TxValidityUpperBound MaryEra)
txUpdateProposal :: TxUpdateProposal MaryEra
txOuts :: [TxOut MaryEra]
txMintValue :: TxMintValue MaryEra
txMetadata :: TxMetadataInEra MaryEra
txIns :: [TxIn]
txFee :: TxFee MaryEra
txCertificates :: TxCertificates MaryEra
txAuxScripts :: TxAuxScripts MaryEra
txMintValue :: TxMintValue MaryEra
txUpdateProposal :: forall era. TxUpdateProposal era
txCertificates :: forall era. TxCertificates era
txWithdrawals :: forall era. TxWithdrawals era
txAuxScripts :: TxAuxScripts MaryEra
txMetadata :: TxMetadataInEra MaryEra
txValidityRange :: (TxValidityLowerBound MaryEra, TxValidityUpperBound MaryEra)
txFee :: TxFee MaryEra
txOuts :: [TxOut MaryEra]
txIns :: [TxIn]
</span><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | Include the fee in a transaction.</span><span>
</span><span id="line-107"></span><span id="local-6989586621679123564"><span class="annot"><a href="Mantis.Transaction.html#includeFee"><span class="hs-identifier hs-type">includeFee</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679123564"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-108"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679123564"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-109"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span>                         </span><span class="hs-comment">-- ^ The network.</span><span>
</span><span id="line-110"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ProtocolParameters</span></span><span>                </span><span class="hs-comment">-- ^ The protocol parameters.</span><span>
</span><span id="line-111"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                               </span><span class="hs-comment">-- ^ The number of inputs.</span><span>
</span><span id="line-112"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                               </span><span class="hs-comment">-- ^ The number of outputs.</span><span>
</span><span id="line-113"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                               </span><span class="hs-comment">-- ^ The number of Shelley witnesses.</span><span>
</span><span id="line-114"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                               </span><span class="hs-comment">-- ^ The number of Byron witnesses.</span><span>
</span><span id="line-115"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBodyContent</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span>             </span><span class="hs-comment">-- ^ The transaction body.</span><span>
</span><span id="line-116"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mantis.Types.html#MantisM"><span class="hs-identifier hs-type">MantisM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123564"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxBodyContent</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Action for the transaction body with fee included.</span></span><span>
</span><span id="line-117"></span><span id="includeFee"><span class="annot"><span class="annottext">includeFee :: NetworkId
-&gt; ProtocolParameters
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; TxBodyContent MaryEra
-&gt; MantisM m (TxBodyContent MaryEra)
</span><a href="Mantis.Transaction.html#includeFee"><span class="hs-identifier hs-var hs-var">includeFee</span></a></span></span><span> </span><span id="local-6989586621679123563"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679123563"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679123562"><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679123562"><span class="hs-identifier hs-var">pparams</span></a></span></span><span> </span><span id="local-6989586621679123561"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123561"><span class="hs-identifier hs-var">nIn</span></a></span></span><span> </span><span id="local-6989586621679123560"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123560"><span class="hs-identifier hs-var">nOut</span></a></span></span><span> </span><span id="local-6989586621679123559"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123559"><span class="hs-identifier hs-var">nShelley</span></a></span></span><span> </span><span id="local-6989586621679123558"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123558"><span class="hs-identifier hs-var">nByron</span></a></span></span><span> </span><span id="local-6989586621679123557"><span class="annot"><span class="annottext">TxBodyContent MaryEra
</span><a href="#local-6989586621679123557"><span class="hs-identifier hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679123556"><span class="annot"><span class="annottext">TxBody MaryEra
</span><a href="#local-6989586621679123556"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either (TxBodyError MaryEra) (TxBody MaryEra)
-&gt; MantisM m (TxBody MaryEra)
forall (m :: * -&gt; *) e a.
(Monad m, Show e) =&gt;
Either e a -&gt; MantisM m a
</span><a href="Mantis.Types.html#foistMantisEither"><span class="hs-identifier hs-var">foistMantisEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (TxBodyError MaryEra) (TxBody MaryEra)
 -&gt; MantisM m (TxBody MaryEra))
-&gt; Either (TxBodyError MaryEra) (TxBody MaryEra)
-&gt; MantisM m (TxBody MaryEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxBodyContent MaryEra
-&gt; Either (TxBodyError MaryEra) (TxBody MaryEra)
forall era.
IsCardanoEra era =&gt;
TxBodyContent era -&gt; Either (TxBodyError era) (TxBody era)
</span><span class="hs-identifier hs-var">makeTransactionBody</span></span><span> </span><span class="annot"><span class="annottext">TxBodyContent MaryEra
</span><a href="#local-6989586621679123557"><span class="hs-identifier hs-var">content</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-121"></span><span>      </span><span id="local-6989586621679123555"><span class="annot"><span class="annottext">tx :: Tx MaryEra
</span><a href="#local-6989586621679123555"><span class="hs-identifier hs-var hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Witness MaryEra] -&gt; TxBody MaryEra -&gt; Tx MaryEra
forall era. [Witness era] -&gt; TxBody era -&gt; Tx era
</span><span class="hs-identifier hs-var">makeSignedTransaction</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">TxBody MaryEra
</span><a href="#local-6989586621679123556"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-122"></span><span>      </span><span id="local-6989586621679123554"><span class="annot"><span class="annottext">lovelace :: Lovelace
</span><a href="#local-6989586621679123554"><span class="hs-identifier hs-var hs-var">lovelace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; Natural
-&gt; Natural
-&gt; Tx MaryEra
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Lovelace
forall era.
IsShelleyBasedEra era =&gt;
NetworkId
-&gt; Natural
-&gt; Natural
-&gt; Tx era
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Lovelace
</span><span class="hs-identifier hs-var">estimateTransactionFee</span></span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679123563"><span class="hs-identifier hs-var">network</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProtocolParameters -&gt; Natural
</span><span class="hs-identifier hs-var hs-var">protocolParamTxFeeFixed</span></span><span>   </span><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679123562"><span class="hs-identifier hs-var">pparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProtocolParameters -&gt; Natural
</span><span class="hs-identifier hs-var hs-var">protocolParamTxFeePerByte</span></span><span> </span><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679123562"><span class="hs-identifier hs-var">pparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><span class="annottext">Tx MaryEra
</span><a href="#local-6989586621679123555"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123561"><span class="hs-identifier hs-var">nIn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123560"><span class="hs-identifier hs-var">nOut</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123559"><span class="hs-identifier hs-var">nShelley</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123558"><span class="hs-identifier hs-var">nByron</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span id="local-6989586621679123552"><span class="annot"><span class="annottext">AddressInEra MaryEra
</span><a href="#local-6989586621679123552"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOutValue</span></span><span> </span><span id="local-6989586621679123550"><span class="annot"><span class="annottext">MultiAssetSupportedInEra MaryEra
</span><a href="#local-6989586621679123550"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679123549"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123549"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TxOut MaryEra] -&gt; MantisM m [TxOut MaryEra]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([TxOut MaryEra] -&gt; MantisM m [TxOut MaryEra])
-&gt; [TxOut MaryEra] -&gt; MantisM m [TxOut MaryEra]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxBodyContent MaryEra -&gt; [TxOut MaryEra]
forall era. TxBodyContent era -&gt; [TxOut era]
</span><span class="hs-identifier hs-var hs-var">txOuts</span></span><span> </span><span class="annot"><span class="annottext">TxBodyContent MaryEra
</span><a href="#local-6989586621679123557"><span class="hs-identifier hs-var">content</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-130"></span><span>      </span><span id="local-6989586621679123548"><span class="annot"><span class="annottext">fee :: Value
</span><a href="#local-6989586621679123548"><span class="hs-identifier hs-var hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><span class="hs-identifier hs-var">negateValue</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; Value -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679123554"><span class="hs-identifier hs-var">lovelace</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">TxBodyContent MaryEra -&gt; MantisM m (TxBodyContent MaryEra)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><span class="annottext">(TxBodyContent MaryEra -&gt; MantisM m (TxBodyContent MaryEra))
-&gt; TxBodyContent MaryEra -&gt; MantisM m (TxBodyContent MaryEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxBodyContent MaryEra
</span><a href="#local-6989586621679123557"><span class="hs-identifier hs-var">content</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="hs-special">{</span><span>
</span><span id="line-134"></span><span>          </span><span class="annot"><span class="annottext">txFee :: TxFee MaryEra
</span><span class="hs-identifier hs-var">txFee</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxFeesExplicitInEra MaryEra -&gt; Lovelace -&gt; TxFee MaryEra
forall era. TxFeesExplicitInEra era -&gt; Lovelace -&gt; TxFee era
</span><span class="hs-identifier hs-var">TxFeeExplicit</span></span><span> </span><span class="annot"><span class="annottext">TxFeesExplicitInEra MaryEra
</span><a href="Mantis.Transaction.html#explicitFees"><span class="hs-identifier hs-var">explicitFees</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679123554"><span class="hs-identifier hs-var">lovelace</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txOuts :: [TxOut MaryEra]
</span><span class="hs-identifier hs-var">txOuts</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AddressInEra MaryEra -&gt; TxOutValue MaryEra -&gt; TxOut MaryEra
forall era. AddressInEra era -&gt; TxOutValue era -&gt; TxOut era
</span><span class="hs-identifier hs-var">TxOut</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra MaryEra
</span><a href="#local-6989586621679123552"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MultiAssetSupportedInEra MaryEra -&gt; Value -&gt; TxOutValue MaryEra
forall era. MultiAssetSupportedInEra era -&gt; Value -&gt; TxOutValue era
</span><span class="hs-identifier hs-var">TxOutValue</span></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra MaryEra
</span><a href="#local-6989586621679123550"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; TxOutValue MaryEra) -&gt; Value -&gt; TxOutValue MaryEra
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123549"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123548"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | Read JSON metadata from a file.</span><span>
</span><span id="line-140"></span><span id="local-6989586621679123697"><span class="annot"><a href="Mantis.Transaction.html#readMetadata%27"><span class="hs-identifier hs-type">readMetadata'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679123697"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-141"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>                        </span><span class="hs-comment">-- ^ Path to the metadata file.</span><span>
</span><span id="line-142"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mantis.Types.html#MantisM"><span class="hs-identifier hs-type">MantisM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123697"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.Value</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxMetadata</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Action for reading the file as JSON and metadata.</span></span><span>
</span><span id="line-143"></span><span id="readMetadata%27"><span class="annot"><span class="annottext">readMetadata' :: FilePath -&gt; MantisM m (Value, TxMetadata)
</span><a href="Mantis.Transaction.html#readMetadata%27"><span class="hs-identifier hs-var hs-var">readMetadata'</span></a></span></span><span> </span><span id="local-6989586621679123546"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123546"><span class="hs-identifier hs-var">filename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679123545"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123545"><span class="hs-identifier hs-var">json</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Maybe Value) -&gt; MantisM m Value
forall (m :: * -&gt; *) a.
MonadIO m =&gt;
FilePath -&gt; IO (Maybe a) -&gt; MantisM m a
</span><a href="Mantis.Types.html#foistMantisMaybeIO"><span class="hs-identifier hs-var">foistMantisMaybeIO</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Could not decode metadata.&quot;</span></span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><span class="annottext">(IO (Maybe Value) -&gt; MantisM m Value)
-&gt; IO (Maybe Value) -&gt; MantisM m Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Maybe Value)
forall a. FromJSON a =&gt; FilePath -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">A.decodeFileStrict</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123546"><span class="hs-identifier hs-var">filename</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679123544"><span class="annot"><span class="annottext">TxMetadata
</span><a href="#local-6989586621679123544"><span class="hs-identifier hs-var">metadata</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-149"></span><span>      </span><span class="annot"><span class="annottext">Either TxMetadataJsonError TxMetadata -&gt; MantisM m TxMetadata
forall (m :: * -&gt; *) e a.
(Monad m, Show e) =&gt;
Either e a -&gt; MantisM m a
</span><a href="Mantis.Types.html#foistMantisEither"><span class="hs-identifier hs-var">foistMantisEither</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="annottext">(Either TxMetadataJsonError TxMetadata -&gt; MantisM m TxMetadata)
-&gt; Either TxMetadataJsonError TxMetadata -&gt; MantisM m TxMetadata
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxMetadataJsonSchema
-&gt; Value -&gt; Either TxMetadataJsonError TxMetadata
</span><span class="hs-identifier hs-var">metadataFromJson</span></span><span> </span><span class="annot"><span class="annottext">TxMetadataJsonSchema
</span><span class="hs-identifier hs-var">TxMetadataJsonNoSchema</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123545"><span class="hs-identifier hs-var">json</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">(Value, TxMetadata) -&gt; MantisM m (Value, TxMetadata)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123545"><span class="hs-identifier hs-var">json</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxMetadata
</span><a href="#local-6989586621679123544"><span class="hs-identifier hs-var">metadata</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Read JSON metadata from a file.</span><span>
</span><span id="line-155"></span><span id="local-6989586621679123542"><span class="annot"><a href="Mantis.Transaction.html#readMetadata"><span class="hs-identifier hs-type">readMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679123542"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-156"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>             </span><span class="hs-comment">-- ^ Path to the metadata file.</span><span>
</span><span id="line-157"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mantis.Types.html#MantisM"><span class="hs-identifier hs-type">MantisM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123542"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxMetadata</span></span><span> </span><span class="hs-comment">-- ^ Action for reading the file as metadata.</span></span><span>
</span><span id="line-158"></span><span id="readMetadata"><span class="annot"><span class="annottext">readMetadata :: FilePath -&gt; MantisM m TxMetadata
</span><a href="Mantis.Transaction.html#readMetadata"><span class="hs-identifier hs-var hs-var">readMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Value, TxMetadata) -&gt; TxMetadata)
-&gt; MantisM m (Value, TxMetadata) -&gt; MantisM m TxMetadata
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Value, TxMetadata) -&gt; TxMetadata
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(MantisM m (Value, TxMetadata) -&gt; MantisM m TxMetadata)
-&gt; (FilePath -&gt; MantisM m (Value, TxMetadata))
-&gt; FilePath
-&gt; MantisM m TxMetadata
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; MantisM m (Value, TxMetadata)
forall (m :: * -&gt; *).
MonadIO m =&gt;
FilePath -&gt; MantisM m (Value, TxMetadata)
</span><a href="Mantis.Transaction.html#readMetadata%27"><span class="hs-identifier hs-var">readMetadata'</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | Print information about a UTxO.</span><span>
</span><span id="line-162"></span><span id="local-6989586621679123541"><span class="annot"><a href="Mantis.Transaction.html#printUTxO"><span class="hs-identifier hs-type">printUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679123541"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-163"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ How much to indent the output.</span><span>
</span><span id="line-164"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span> </span><span class="hs-comment">-- ^ The UTxO.</span><span>
</span><span id="line-165"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mantis.Types.html#MantisM"><span class="hs-identifier hs-type">MantisM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123541"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Action to print the information.</span></span><span>
</span><span id="line-166"></span><span id="printUTxO"><span class="annot"><span class="annottext">printUTxO :: FilePath -&gt; UTxO MaryEra -&gt; MantisM m ()
</span><a href="Mantis.Transaction.html#printUTxO"><span class="hs-identifier hs-var hs-var">printUTxO</span></a></span></span><span> </span><span id="local-6989586621679123539"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123539"><span class="hs-identifier hs-var">indent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span id="local-6989586621679123537"><span class="annot"><span class="annottext">Map TxIn (TxOut MaryEra)
</span><a href="#local-6989586621679123537"><span class="hs-identifier hs-var">utxoMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><span class="annottext">[MantisM m ()] -&gt; MantisM m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">[</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-keyword">do</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; MantisM m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span>
</span><span id="line-171"></span><span>          </span><span class="annot"><span class="annottext">(IO () -&gt; MantisM m ())
-&gt; (FilePath -&gt; IO ()) -&gt; FilePath -&gt; MantisM m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span>
</span><span id="line-172"></span><span>          </span><span class="annot"><span class="annottext">(FilePath -&gt; MantisM m ()) -&gt; FilePath -&gt; MantisM m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123539"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Transaction: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Hash Blake2b_256 EraIndependentTxBody -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="Mantis.Transaction.html#show%27"><span class="hs-identifier hs-var">show'</span></a></span><span> </span><span class="annot"><span class="annottext">Hash StandardCrypto EraIndependentTxBody
Hash Blake2b_256 EraIndependentTxBody
</span><a href="#local-6989586621679123533"><span class="hs-identifier hs-var">txhash</span></a></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;#&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">TxIx -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TxIx
</span><a href="#local-6989586621679123531"><span class="hs-identifier hs-var">txin</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; Value -&gt; MantisM m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
FilePath -&gt; Value -&gt; MantisM m ()
</span><a href="Mantis.Transaction.html#printValue"><span class="hs-identifier hs-var">printValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123539"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;  &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123530"><span class="hs-identifier hs-var">value'</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">|</span><span>
</span><span id="line-175"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxId</span></span><span> </span><span id="local-6989586621679123533"><span class="annot"><span class="annottext">Hash StandardCrypto EraIndependentTxBody
</span><a href="#local-6989586621679123533"><span class="hs-identifier hs-var">txhash</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679123531"><span class="annot"><span class="annottext">TxIx
</span><a href="#local-6989586621679123531"><span class="hs-identifier hs-var">txin</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra MaryEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOutValue</span></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra MaryEra
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679123530"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123530"><span class="hs-identifier hs-var">value'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut MaryEra) -&gt; [(TxIn, TxOut MaryEra)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.assocs</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut MaryEra)
</span><a href="#local-6989586621679123537"><span class="hs-identifier hs-var">utxoMap</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Print a value.</span><span>
</span><span id="line-180"></span><span id="local-6989586621679123680"><span class="annot"><a href="Mantis.Transaction.html#printValue"><span class="hs-identifier hs-type">printValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679123680"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-181"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ How much to indent the output.</span><span>
</span><span id="line-182"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span>        </span><span class="hs-comment">-- ^ The value.</span><span>
</span><span id="line-183"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mantis.Types.html#MantisM"><span class="hs-identifier hs-type">MantisM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123680"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Action to print the information.</span></span><span>
</span><span id="line-184"></span><span id="printValue"><span class="annot"><span class="annottext">printValue :: FilePath -&gt; Value -&gt; MantisM m ()
</span><a href="Mantis.Transaction.html#printValue"><span class="hs-identifier hs-var hs-var">printValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO () -&gt; MantisM m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; MantisM m ())
-&gt; (Value -&gt; IO ()) -&gt; Value -&gt; MantisM m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Value -&gt; IO ()) -&gt; Value -&gt; MantisM m ())
-&gt; (FilePath -&gt; Value -&gt; IO ())
-&gt; FilePath
-&gt; Value
-&gt; MantisM m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Value -&gt; IO ()
</span><a href="Mantis.Transaction.html#printValueIO"><span class="hs-identifier hs-var">printValueIO</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | Print a value.</span><span>
</span><span id="line-188"></span><span class="annot"><a href="Mantis.Transaction.html#printValueIO"><span class="hs-identifier hs-type">printValueIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-189"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-comment">-- ^ The value.</span><span>
</span><span id="line-190"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Action to print the information.</span><span>
</span><span id="line-191"></span><span id="printValueIO"><span class="annot"><span class="annottext">printValueIO :: FilePath -&gt; Value -&gt; IO ()
</span><a href="Mantis.Transaction.html#printValueIO"><span class="hs-identifier hs-var hs-var">printValueIO</span></a></span></span><span> </span><span id="local-6989586621679123527"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123527"><span class="hs-identifier hs-var">indent</span></a></span></span><span> </span><span id="local-6989586621679123526"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123526"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123527"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Lovelace
</span><span class="hs-identifier hs-var">selectLovelace</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123526"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">[IO ()] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-special">[</span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123527"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621679123525"><span class="hs-identifier hs-var">quantity</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="Mantis.Transaction.html#show%27"><span class="hs-identifier hs-var">show'</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621679123524"><span class="hs-identifier hs-var">policy</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="Mantis.Transaction.html#show%27"><span class="hs-identifier hs-var">show'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123523"><span class="hs-identifier hs-var">asset</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-glyph">|</span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssetId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PolicyId</span></span><span> </span><span id="local-6989586621679123524"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621679123524"><span class="hs-identifier hs-var">policy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssetName</span></span><span> </span><span id="local-6989586621679123523"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123523"><span class="hs-identifier hs-var">asset</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679123525"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621679123525"><span class="hs-identifier hs-var">quantity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Value -&gt; [(AssetId, Quantity)]
</span><span class="hs-identifier hs-var">valueToList</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; [(AssetId, Quantity)]) -&gt; Value -&gt; [(AssetId, Quantity)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(AssetId -&gt; Bool) -&gt; Value -&gt; Value
</span><span class="hs-identifier hs-var">filterValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssetId -&gt; AssetId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">AssetId
</span><span class="hs-identifier hs-var">AdaAssetId</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123526"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | Strip a leading and trailing quotation mark when showing a string.</span><span>
</span><span id="line-203"></span><span id="local-6989586621679123684"><span class="annot"><a href="Mantis.Transaction.html#show%27"><span class="hs-identifier hs-type">show'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679123684"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-204"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679123684"><span class="hs-identifier hs-type">a</span></a></span><span>      </span><span class="hs-comment">-- ^ The value.</span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ The string represenation.</span></span><span>
</span><span id="line-206"></span><span id="show%27"><span class="annot"><span class="annottext">show' :: a -&gt; FilePath
</span><a href="Mantis.Transaction.html#show%27"><span class="hs-identifier hs-var hs-var">show'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; (a -&gt; FilePath) -&gt; a -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; (a -&gt; FilePath) -&gt; a -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | Summarize the values in a UTxO.</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Mantis.Transaction.html#summarizeValues"><span class="hs-identifier hs-type">summarizeValues</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span> </span><span class="hs-comment">-- ^ The UTxO.</span><span>
</span><span id="line-211"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The number of values and their total.</span><span>
</span><span id="line-212"></span><span id="summarizeValues"><span class="annot"><span class="annottext">summarizeValues :: UTxO MaryEra -&gt; (Int, Value)
</span><a href="Mantis.Transaction.html#summarizeValues"><span class="hs-identifier hs-var hs-var">summarizeValues</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span id="local-6989586621679123515"><span class="annot"><span class="annottext">Map TxIn (TxOut MaryEra)
</span><a href="#local-6989586621679123515"><span class="hs-identifier hs-var">utxoMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679123514"><span class="annot"><span class="annottext">values :: [Value]
</span><a href="#local-6989586621679123514"><span class="hs-identifier hs-var hs-var">values</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-special">[</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123513"><span class="hs-identifier hs-var">value'</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span class="hs-glyph">|</span><span>
</span><span id="line-218"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra MaryEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOutValue</span></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra MaryEra
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679123513"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123513"><span class="hs-identifier hs-var">value'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut MaryEra) -&gt; [(TxIn, TxOut MaryEra)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.assocs</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut MaryEra)
</span><a href="#local-6989586621679123515"><span class="hs-identifier hs-var">utxoMap</span></a></span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679123514"><span class="hs-identifier hs-var">values</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679123514"><span class="hs-identifier hs-var">values</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Prepare a minting script.</span><span>
</span><span id="line-225"></span><span class="annot"><a href="Mantis.Transaction.html#makeMinting"><span class="hs-identifier hs-type">makeMinting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span>                               </span><span class="hs-comment">-- ^ The value to which minting will be added.</span><span>
</span><span id="line-226"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                              </span><span class="hs-comment">-- ^ The asset name.</span><span>
</span><span id="line-227"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>                             </span><span class="hs-comment">-- ^ The number of tokens to omit.</span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span>                     </span><span class="hs-comment">-- ^ Hash of the payment key.</span><span>
</span><span id="line-229"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>                        </span><span class="hs-comment">-- ^ The last slot number for minting.</span><span>
</span><span id="line-230"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ScriptInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The minting script, value minted, and total value.</span><span>
</span><span id="line-231"></span><span id="makeMinting"><span class="annot"><span class="annottext">makeMinting :: Value
-&gt; FilePath
-&gt; Integer
-&gt; Hash PaymentKey
-&gt; Maybe SlotNo
-&gt; (ScriptInEra MaryEra, Value, Value)
</span><a href="Mantis.Transaction.html#makeMinting"><span class="hs-identifier hs-var hs-var">makeMinting</span></a></span></span><span> </span><span id="local-6989586621679123511"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123511"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679123510"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123510"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679123509"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679123509"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span id="local-6989586621679123508"><span class="annot"><span class="annottext">Hash PaymentKey
</span><a href="#local-6989586621679123508"><span class="hs-identifier hs-var">verification</span></a></span></span><span> </span><span id="local-6989586621679123507"><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="#local-6989586621679123507"><span class="hs-identifier hs-var">before</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679123506"><span class="annot"><span class="annottext">ScriptInEra MaryEra
</span><a href="#local-6989586621679123506"><span class="hs-identifier hs-var">script</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679123505"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621679123505"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash PaymentKey
-&gt; Maybe SlotNo -&gt; (ScriptInEra MaryEra, ScriptHash)
</span><a href="Mantis.Script.html#mintingScript"><span class="hs-identifier hs-var">mintingScript</span></a></span><span> </span><span class="annot"><span class="annottext">Hash PaymentKey
</span><a href="#local-6989586621679123508"><span class="hs-identifier hs-var">verification</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="#local-6989586621679123507"><span class="hs-identifier hs-var">before</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679123504"><span class="annot"><span class="annottext">minting :: Value
</span><a href="#local-6989586621679123504"><span class="hs-identifier hs-var hs-var">minting</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AssetId, Quantity)] -&gt; Value
</span><span class="hs-identifier hs-var">valueFromList</span></span><span>
</span><span id="line-235"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span>
</span><span id="line-236"></span><span>        </span><span class="annot"><span class="annottext">PolicyId -&gt; AssetName -&gt; AssetId
</span><span class="hs-identifier hs-var">AssetId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash -&gt; PolicyId
</span><span class="hs-identifier hs-var">PolicyId</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621679123505"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; AssetName
</span><span class="hs-identifier hs-var">AssetName</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; AssetName) -&gt; ByteString -&gt; AssetName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123510"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Quantity
</span><span class="hs-identifier hs-var">Quantity</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679123509"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><span class="annottext">ScriptInEra MaryEra
</span><a href="#local-6989586621679123506"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123504"><span class="hs-identifier hs-var">minting</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123511"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123504"><span class="hs-identifier hs-var">minting</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- | Prepare for minting from a JSON file specifying NFTs.</span><span>
</span><span id="line-248"></span><span id="local-6989586621679123502"><span class="annot"><a href="Mantis.Transaction.html#readMinting"><span class="hs-identifier hs-type">readMinting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679123502"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-249"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679123502"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-250"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PolicyId</span></span><span>                               </span><span class="hs-comment">-- ^ The policy ID.</span><span>
</span><span id="line-251"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>                               </span><span class="hs-comment">-- ^ Path to the metadata file.</span><span>
</span><span id="line-252"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mantis.Types.html#MantisM"><span class="hs-identifier hs-type">MantisM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123502"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.Value</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxMetadata</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Action reading the metadata file and returning the JSON, metadata, and value for minting.</span></span><span>
</span><span id="line-253"></span><span id="readMinting"><span class="annot"><span class="annottext">readMinting :: PolicyId -&gt; FilePath -&gt; MantisM m (Value, TxMetadata, Value)
</span><a href="Mantis.Transaction.html#readMinting"><span class="hs-identifier hs-var hs-var">readMinting</span></a></span></span><span> </span><span id="local-6989586621679123501"><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679123501"><span class="hs-identifier hs-var">policyId</span></a></span></span><span> </span><span id="local-6989586621679123500"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123500"><span class="hs-identifier hs-var">filename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">A.Object</span></span><span> </span><span id="local-6989586621679123498"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679123498"><span class="hs-identifier hs-var">json</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Maybe Value) -&gt; MantisM m Value
forall (m :: * -&gt; *) a.
MonadIO m =&gt;
FilePath -&gt; IO (Maybe a) -&gt; MantisM m a
</span><a href="Mantis.Types.html#foistMantisMaybeIO"><span class="hs-identifier hs-var">foistMantisMaybeIO</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Could not decode metadata.&quot;</span></span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="annottext">(IO (Maybe Value) -&gt; MantisM m Value)
-&gt; IO (Maybe Value) -&gt; MantisM m Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Maybe Value)
forall a. FromJSON a =&gt; FilePath -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">A.decodeFileStrict</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123500"><span class="hs-identifier hs-var">filename</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-259"></span><span>      </span><span id="local-6989586621679123497"><span class="annot"><span class="annottext">json' :: Value
</span><a href="#local-6989586621679123497"><span class="hs-identifier hs-var hs-var">json'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>        </span><span class="annot"><span class="annottext">Object -&gt; Value
</span><span class="hs-identifier hs-var">A.Object</span></span><span>
</span><span id="line-261"></span><span>        </span><span class="annot"><span class="annottext">(Object -&gt; Value) -&gt; (Object -&gt; Object) -&gt; Object -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value -&gt; Object
forall k v. Hashable k =&gt; k -&gt; v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">H.singleton</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;721&quot;</span></span><span>
</span><span id="line-262"></span><span>        </span><span class="annot"><span class="annottext">(Value -&gt; Object) -&gt; (Object -&gt; Value) -&gt; Object -&gt; Object
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Value
</span><span class="hs-identifier hs-var">A.Object</span></span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">(Object -&gt; Value) -&gt; Object -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value -&gt; Object
forall k v. Hashable k =&gt; k -&gt; v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">H.singleton</span></span><span>
</span><span id="line-264"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text)
-&gt; (ByteString -&gt; FilePath) -&gt; ByteString -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; FilePath
</span><span class="hs-identifier hs-var">BS.unpack</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PolicyId -&gt; ByteString
forall a. SerialiseAsRawBytes a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">serialiseToRawBytesHex</span></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679123501"><span class="hs-identifier hs-var">policyId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Value
</span><span class="hs-identifier hs-var">A.Object</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679123498"><span class="hs-identifier hs-var">json</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>      </span><span id="local-6989586621679123496"><span class="annot"><span class="annottext">minting :: Value
</span><a href="#local-6989586621679123496"><span class="hs-identifier hs-var hs-var">minting</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="annottext">[(AssetId, Quantity)] -&gt; Value
</span><span class="hs-identifier hs-var">valueFromList</span></span><span>
</span><span id="line-268"></span><span>          </span><span class="hs-special">[</span><span>
</span><span id="line-269"></span><span>            </span><span class="hs-special">(</span><span>
</span><span id="line-270"></span><span>              </span><span class="annot"><span class="annottext">PolicyId -&gt; AssetName -&gt; AssetId
</span><span class="hs-identifier hs-var">AssetId</span></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679123501"><span class="hs-identifier hs-var">policyId</span></a></span><span> </span><span class="annot"><span class="annottext">(AssetName -&gt; AssetId)
-&gt; (FilePath -&gt; AssetName) -&gt; FilePath -&gt; AssetId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; AssetName
</span><span class="hs-identifier hs-var">AssetName</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; AssetName)
-&gt; (FilePath -&gt; ByteString) -&gt; FilePath -&gt; AssetName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; AssetId) -&gt; FilePath -&gt; AssetId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679123495"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-271"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Quantity
</span><span class="hs-identifier hs-var">Quantity</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-272"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>          </span><span class="hs-glyph">|</span><span>
</span><span id="line-274"></span><span>            </span><span id="local-6989586621679123495"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679123495"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Text]
forall k v. HashMap k v -&gt; [k]
</span><span class="hs-identifier hs-var">H.keys</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679123498"><span class="hs-identifier hs-var">json</span></a></span><span>
</span><span id="line-275"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679123494"><span class="annot"><span class="annottext">TxMetadata
</span><a href="#local-6989586621679123494"><span class="hs-identifier hs-var">metadata</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><span class="annottext">Either TxMetadataJsonError TxMetadata -&gt; MantisM m TxMetadata
forall (m :: * -&gt; *) e a.
(Monad m, Show e) =&gt;
Either e a -&gt; MantisM m a
</span><a href="Mantis.Types.html#foistMantisEither"><span class="hs-identifier hs-var">foistMantisEither</span></a></span><span>
</span><span id="line-278"></span><span>        </span><span class="annot"><span class="annottext">(Either TxMetadataJsonError TxMetadata -&gt; MantisM m TxMetadata)
-&gt; Either TxMetadataJsonError TxMetadata -&gt; MantisM m TxMetadata
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxMetadataJsonSchema
-&gt; Value -&gt; Either TxMetadataJsonError TxMetadata
</span><span class="hs-identifier hs-var">metadataFromJson</span></span><span> </span><span class="annot"><span class="annottext">TxMetadataJsonSchema
</span><span class="hs-identifier hs-var">TxMetadataJsonNoSchema</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123497"><span class="hs-identifier hs-var">json'</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="annottext">(Value, TxMetadata, Value) -&gt; MantisM m (Value, TxMetadata, Value)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123497"><span class="hs-identifier hs-var">json'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxMetadata
</span><a href="#local-6989586621679123494"><span class="hs-identifier hs-var">metadata</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679123496"><span class="hs-identifier hs-var">minting</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span></pre></body></html>